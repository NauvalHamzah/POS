<%- include('../partials/header') %>
    <%- include('../partials/sidebar') %>
        <%- include('../partials/topbar') %>
            <!-- Begin Page Content -->
            <div class="container-fluid">

                <!-- Page Heading -->
                <h1 class="h3 mb-2 text-gray-800">Goods</h1>

                <!-- DataTales Example -->
                <div class="card shadow mb-4">
                    <div class="card-header py-3">
                        <h6 class="m-0 font-weight-bold text-primary">
                            <%= formHeading%>
                        </h6>
                    </div>
                    <div class="card-body">
                        <form action="" method="post" id="goodsForm" enctype="multipart/form-data">
                            <div class="form-group row mb-2">
                                <label for="unit" class="col-sm-2 col-form-label">Barcode</label>
                                <div class="col-sm-10">
                                    <input type="text" class="form-control" id="barcode" name="barcode"
                                        value="<%= item.barcode ? item.barcode : '' %>" <%=item.barcode ? 'readonly'
                                        : '' %> >
                                </div>
                            </div>
                            <div class="form-group row mb-2">
                                <label for="name" class="col-sm-2 col-form-label">Name</label>
                                <div class="col-sm-10">
                                    <input type="text" class="form-control" id="name" name="name"
                                        value="<%= item.name ? item.name : '' %>">
                                </div>
                            </div>
                            <div class="form-group row mb-2">
                                <label for="note" class="col-sm-2 col-form-label">Stock</label>
                                <div class="col-sm-10">
                                    <input type="number" class="form-control" id="stock" name="stock"
                                        value="<%= item.stock ?? '' %>" step="1" min="0">
                                </div>
                            </div>
                            <div class="form-group row mb-2">
                                <label for="note" class="col-sm-2 col-form-label">Purchase Price</label>
                                <div class="col-sm-10">
                                    <input type="number" class="form-control" id="purchasePrice" name="purchasePrice"
                                        value="<%= item.purchaseprice ? item.purchaseprice : '' %>" step="0.01">
                                </div>
                            </div>
                            <div class="form-group row mb-2">
                                <label for="note" class="col-sm-2 col-form-label">Selling Price</label>
                                <div class="col-sm-10">
                                    <input type="number" class="form-control" id="sellingPrice" name="sellingPrice"
                                        value="<%= item.sellingprice ? item.sellingprice : '' %>" step="0.01">
                                </div>
                            </div>
                            <div class="form-group row mb-2">
                                <label for="unit" class="col-sm-2 col-form-label">Unit</label>
                                <div class="col-sm-10">
                                    <select class="form-control" id="unit" name="unit">
                                        <% units.forEach(function(unit, index) { %>
                                            <option value="<%= unit.unit %>" <%=(item.unit ? item.unit===unit.unit :
                                                index===0) ? 'selected' : '' %>>
                                                <%= unit.unit %>
                                            </option>
                                            <% }) %>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group row mb-2">
                                <label for="picture" class="col-sm-2 col-form-label">Picture</label>
                                <div class="col-sm-10">
                                    <input type="file" class="form-control" id="picture" name="picture" accept="image/*"
                                        onchange="previewImage(event);">
                                </div>
                            </div>
                            <div class="form-group row mb-2">
                                <label for="title" class="col-sm-2 col-form-label">Preview</label>
                                <div class="col-sm-10">
                                    <img id="preview-selected-image" width="400px" src="<%= item.picture %>">
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="card-footer py-3">
                        <button type="submit" form="goodsForm" class="btn btn-success btn-icon-split">
                            <span class="icon text-white-50">
                                <i class="fa-solid fa-database"></i>
                            </span>
                            <span class="text">
                                Save
                            </span>
                        </button>
                        <a href="/goods" class="btn btn-warning btn-icon-split">
                            <span class="icon text-white-50">
                                <i class="fa-solid fa-rotate-left"></i>
                            </span>
                            <span class="text">
                                Back
                            </span>
                        </a>
                    </div>
                </div>
                <script>
                    const previewImage = (event) => {
                        const imageFiles = event.target.files;
                        const imageFilesLength = imageFiles.length;
                        if (imageFilesLength > 0) {
                            const imageSrc = URL.createObjectURL(imageFiles[0]);
                            const imagePreviewElement = document.querySelector("#preview-selected-image");
                            imagePreviewElement.src = imageSrc;
                            imagePreviewElement.style.display = "block";
                        }
                    }
                </script>

            </div>
            <!-- /.container-fluid -->
            <%- include('../partials/footer') %>